:toc:
:toclevels: 4
:toc-placement!:
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
:imagesdir: assets
endif::[]

= Shattered

STOMP meets `bottle.py`

toc::[]

== Getting Started

=== Installation

`pip install shattered`

=== Echo Server

`app.py`

[source,python]
----
import logging

from shattered import Shattered


logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

app = Shattered(host="rabbitmq")


@app.subscribe("/queue/echo")
def echo(headers, body, conn):
    logger.info("Message headers: %s", headers)
    logger.info("Message body: %s", body)
    logger.info("Connection: %s", conn)


@app.subscribe("/queue/echo")
def echo_fancy(headers, body, conn):
    logger.info("%s %s", headers, body)


app.run()
----

==== Running the Demo

Start up RabbitMQ using `docker-compose up`

In another shell, run `docker-compose run shattered python examples/echo/echo.py`

In another shell, run `docker-compose run shattered python examples/echo/send.py`
